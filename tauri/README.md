# Tauri

## 简介

`tauri`是用于构建多平台部署一个<u>优化的、安全的、独立于前端的应用程序</u>的框架。可访问[https://v2.tauri.app/zh-cn/](https://v2.tauri.app/zh-cn/)了解更多。

## 搭建项目

### 创建项目
```bash
yarn create vite
```

```bash
yarn create v1.22.19
[1/4] 🔍  Resolving packages...
[2/4] 🚚  Fetching packages...
[3/4] 🔗  Linking dependencies...
[4/4] 🔨  Building fresh packages...
success Installed "create-vite@5.5.5" with binaries:
      - create-vite
      - cva
? Project name: › vite-project
```

### 输入项目名

```bash
yarn create v1.22.19
[1/4] 🔍  Resolving packages...
[2/4] 🚚  Fetching packages...
[3/4] 🔗  Linking dependencies...
[4/4] 🔨  Building fresh packages...
success Installed "create-vite@5.5.5" with binaries:
      - create-vite
      - cva
? Project name: › vite-react-tauri
```

### 选择框架

```bash
yarn create v1.22.19
[1/4] 🔍  Resolving packages...
[2/4] 🚚  Fetching packages...
[3/4] 🔗  Linking dependencies...
[4/4] 🔨  Building fresh packages...
success Installed "create-vite@5.5.5" with binaries:
      - create-vite
      - cva
✔ Project name: … vite-react-tauri
? Select a framework: › - Use arrow-keys. Return to submit.
    Vanilla
    Vue
❯   React
    Preact
    Lit
    Svelte
    Solid
    Qwik
    Angular
    Others
```

### 选择开发语言

```bash
yarn create v1.22.19
[1/4] 🔍  Resolving packages...
[2/4] 🚚  Fetching packages...
[3/4] 🔗  Linking dependencies...
[4/4] 🔨  Building fresh packages...
success Installed "create-vite@5.5.5" with binaries:
      - create-vite
      - cva
✔ Project name: … vite-react-tauri
✔ Select a framework: › React
? Select a variant: › - Use arrow-keys. Return to submit.
❯   TypeScript
    TypeScript + SWC
    JavaScript
    JavaScript + SWC
    Remix ↗
```

```bash
yarn create v1.22.19
[1/4] 🔍  Resolving packages...
[2/4] 🚚  Fetching packages...
[3/4] 🔗  Linking dependencies...
[4/4] 🔨  Building fresh packages...
success Installed "create-vite@5.5.5" with binaries:
      - create-vite
      - cva
✔ Project name: … vite-react-tauri
✔ Select a framework: › React
✔ Select a variant: › TypeScript

Scaffolding project in /Users/weizuxiao/Documents/weizuxiao/learning-notes/tauri/vite-react-tauri...

Done. Now run:

  cd vite-react-tauri
  yarn
  yarn dev

✨  Done in 82.56s.
```

### 修改`vite.config.ts`

```ts
import { defineConfig } from 'vite'

export default defineConfig({
  // prevent vite from obscuring rust errors
  clearScreen: false,
  // Tauri expects a fixed port, fail if that port is not available
  server: {
    strictPort: true,
  },
  // to access the Tauri environment variables set by the CLI with information about the current target
  envPrefix: ['VITE_', 'TAURI_PLATFORM', 'TAURI_ARCH', 'TAURI_FAMILY', 'TAURI_PLATFORM_VERSION', 'TAURI_PLATFORM_TYPE', 'TAURI_DEBUG'],
  build: {
    // Tauri uses Chromium on Windows and WebKit on macOS and Linux
    target: process.env.TAURI_PLATFORM == 'windows' ? 'chrome105' : 'safari13',
    // don't minify for debug builds
    minify: !process.env.TAURI_DEBUG ? 'esbuild' : false,
    // produce sourcemaps for debug builds
    sourcemap: !!process.env.TAURI_DEBUG,
  },
})
```

### 创建`Rust`工程

```bash
yarn add -D @tauri-apps/cli@^1.0.0
```

```bash
yarn add v1.22.19
info No lockfile found.
warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.
[1/4] 🔍  Resolving packages...
[2/4] 🚚  Fetching packages...
[3/4] 🔗  Linking dependencies...
[4/4] 🔨  Building fresh packages...
success Saved lockfile.
success Saved 153 new dependencies.
info Direct dependencies
├─ @eslint/js@9.15.0
├─ @tauri-apps/cli@1.6.3
├─ @types/node@22.9.4
├─ @types/react-dom@18.3.1
├─ @types/react@18.3.12
├─ @vitejs/plugin-react@4.3.3
├─ eslint-plugin-react-hooks@5.0.0
├─ eslint-plugin-react-refresh@0.4.14
├─ eslint@9.15.0
├─ globals@15.12.0
├─ react-dom@18.3.1
├─ react@18.3.1
├─ typescript-eslint@8.16.0
├─ typescript@5.6.3
└─ vite@5.4.11
info All dependencies
├─ @ampproject/remapping@2.3.0
├─ @babel/compat-data@7.26.2
├─ @babel/core@7.26.0
├─ @babel/generator@7.26.2
├─ @babel/helper-compilation-targets@7.25.9
├─ @babel/helper-module-imports@7.25.9
├─ @babel/helper-module-transforms@7.26.0
├─ @babel/helper-string-parser@7.25.9
├─ @babel/helper-validator-option@7.25.9
├─ @babel/helpers@7.26.0
├─ @babel/parser@7.26.2
├─ @babel/plugin-transform-react-jsx-self@7.25.9
├─ @babel/plugin-transform-react-jsx-source@7.25.9
├─ @esbuild/darwin-arm64@0.21.5
├─ @eslint-community/eslint-utils@4.4.1
├─ @eslint-community/regexpp@4.12.1
├─ @eslint/config-array@0.19.0
├─ @eslint/core@0.9.0
├─ @eslint/eslintrc@3.2.0
├─ @eslint/js@9.15.0
├─ @eslint/object-schema@2.1.4
├─ @eslint/plugin-kit@0.2.3
├─ @humanfs/core@0.19.1
├─ @humanfs/node@0.16.6
├─ @humanwhocodes/module-importer@1.0.1
├─ @humanwhocodes/retry@0.4.1
├─ @jridgewell/resolve-uri@3.1.2
├─ @jridgewell/set-array@1.2.1
├─ @jridgewell/sourcemap-codec@1.5.0
├─ @nodelib/fs.scandir@2.1.5
├─ @nodelib/fs.stat@2.0.5
├─ @nodelib/fs.walk@1.2.8
├─ @rollup/rollup-darwin-arm64@4.27.4
├─ @tauri-apps/cli-darwin-arm64@1.6.3
├─ @tauri-apps/cli@1.6.3
├─ @types/babel__core@7.20.5
├─ @types/babel__generator@7.6.8
├─ @types/babel__template@7.4.4
├─ @types/babel__traverse@7.20.6
├─ @types/estree@1.0.6
├─ @types/json-schema@7.0.15
├─ @types/node@22.9.4
├─ @types/prop-types@15.7.13
├─ @types/react-dom@18.3.1
├─ @types/react@18.3.12
├─ @typescript-eslint/eslint-plugin@8.16.0
├─ @typescript-eslint/parser@8.16.0
├─ @typescript-eslint/type-utils@8.16.0
├─ @vitejs/plugin-react@4.3.3
├─ acorn-jsx@5.3.2
├─ acorn@8.14.0
├─ ansi-styles@4.3.0
├─ argparse@2.0.1
├─ brace-expansion@1.1.11
├─ braces@3.0.3
├─ browserslist@4.24.2
├─ callsites@3.1.0
├─ caniuse-lite@1.0.30001684
├─ chalk@4.1.2
├─ color-convert@2.0.1
├─ color-name@1.1.4
├─ concat-map@0.0.1
├─ convert-source-map@2.0.0
├─ cross-spawn@7.0.6
├─ csstype@3.1.3
├─ deep-is@0.1.4
├─ electron-to-chromium@1.5.65
├─ esbuild@0.21.5
├─ escalade@3.2.0
├─ escape-string-regexp@4.0.0
├─ eslint-plugin-react-hooks@5.0.0
├─ eslint-plugin-react-refresh@0.4.14
├─ eslint-scope@8.2.0
├─ eslint@9.15.0
├─ espree@10.3.0
├─ esquery@1.6.0
├─ esrecurse@4.3.0
├─ esutils@2.0.3
├─ fast-deep-equal@3.1.3
├─ fast-glob@3.3.2
├─ fast-json-stable-stringify@2.1.0
├─ fast-levenshtein@2.0.6
├─ fastq@1.17.1
├─ file-entry-cache@8.0.0
├─ fill-range@7.1.1
├─ find-up@5.0.0
├─ flat-cache@4.0.1
├─ flatted@3.3.2
├─ fsevents@2.3.3
├─ gensync@1.0.0-beta.2
├─ glob-parent@6.0.2
├─ globals@15.12.0
├─ graphemer@1.4.0
├─ has-flag@4.0.0
├─ ignore@5.3.2
├─ import-fresh@3.3.0
├─ imurmurhash@0.1.4
├─ is-extglob@2.1.1
├─ is-glob@4.0.3
├─ is-number@7.0.0
├─ isexe@2.0.0
├─ js-tokens@4.0.0
├─ js-yaml@4.1.0
├─ jsesc@3.0.2
├─ json-buffer@3.0.1
├─ json-schema-traverse@0.4.1
├─ json-stable-stringify-without-jsonify@1.0.1
├─ json5@2.2.3
├─ keyv@4.5.4
├─ locate-path@6.0.0
├─ lodash.merge@4.6.2
├─ lru-cache@5.1.1
├─ merge2@1.4.1
├─ micromatch@4.0.8
├─ ms@2.1.3
├─ nanoid@3.3.7
├─ node-releases@2.0.18
├─ optionator@0.9.4
├─ p-limit@3.1.0
├─ p-locate@5.0.0
├─ parent-module@1.0.1
├─ path-exists@4.0.0
├─ path-key@3.1.1
├─ picocolors@1.1.1
├─ picomatch@2.3.1
├─ postcss@8.4.49
├─ punycode@2.3.1
├─ queue-microtask@1.2.3
├─ react-dom@18.3.1
├─ react-refresh@0.14.2
├─ react@18.3.1
├─ resolve-from@4.0.0
├─ reusify@1.0.4
├─ rollup@4.27.4
├─ run-parallel@1.2.0
├─ scheduler@0.23.2
├─ shebang-command@2.0.0
├─ shebang-regex@3.0.0
├─ source-map-js@1.2.1
├─ strip-json-comments@3.1.1
├─ supports-color@7.2.0
├─ to-regex-range@5.0.1
├─ type-check@0.4.0
├─ typescript-eslint@8.16.0
├─ typescript@5.6.3
├─ undici-types@6.19.8
├─ update-browserslist-db@1.1.1
├─ uri-js@4.4.1
├─ vite@5.4.11
├─ which@2.0.2
├─ word-wrap@1.2.5
├─ yallist@3.1.1
└─ yocto-queue@0.1.0
✨  Done in 10.18s.
```

```bash
yarn tauri init
```

```bash
yarn run v1.22.19
$ /Users/weizuxiao/Documents/weizuxiao/learning-notes/tauri/vite-react-tauri/node_modules/.bin/tauri init
✔ What is your app name? · vite-react-tauri
✔ What should the window title be? · vite-react-tauri
? Where are your web assets (HTML/CSS/JS) located, relative to the "<current dir>/src-tauri/tauri.conf.json" file that will be cre
✔ Where are your web assets (HTML/CSS/JS) located, relative to the "<current dir>/src-tauri/tauri.conf.json" file that will be created? · ../dist
✔ What is the url of your dev server? · http://localhost:5173
✔ What is your frontend dev command? · npm run dev
✔ What is your frontend build command? · npm run build
✨  Done in 4653.50s.
```

### 运行演示

```bash
yarn tauri dev
```

![](./assets/image1.png)

### IPC通信

```rs
#[tauri::command]
fn greet(name: &str) -> String {
   format!("Hello, {}!", name)
}

fn main() {
  tauri::Builder::default()
    .invoke_handler(tauri::generate_handler![greet])
    .run(tauri::generate_context!())
    .expect("error while running tauri application");
}
```

```bash
yarn add @tauri-apps/api@^1.0.0
```

```tsx
import { useState } from 'react'
import reactLogo from './assets/react.svg'
import viteLogo from '/vite.svg'
import './App.css'
import { invoke } from '@tauri-apps/api'

function App() {
    const [count, setCount] = useState(0)

    const onClick = () => {
        setCount((count) => count + 1)
        invoke('greet', { name: 'World' })
            // `invoke` returns a Promise
            .then((response) => console.log(response))
    }

    return (
        <>
            <div>
                <a href="https://vite.dev" target="_blank">
                    <img src={viteLogo} className="logo" alt="Vite logo" />
                </a>
                <a href="https://react.dev" target="_blank">
                    <img src={reactLogo} className="logo react" alt="React logo" />
                </a>
            </div>
            <h1>Vite + React</h1>
            <div className="card">
                <button onClick={onClick}>
                    count is {count}
                </button>
                <p>
                    Edit <code>src/App.tsx</code> and save to test HMR
                </p>
            </div>
            <p className="read-the-docs">
                Click on the Vite and React logos to learn more
            </p>
        </>
    )
}

export default App

```



